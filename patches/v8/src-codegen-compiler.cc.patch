diff --git a/src/codegen/compiler.cc b/src/codegen/compiler.cc
index 9de4ae24a3aa9c7af7c5c786d4d1d4f0cd66c33d..d086db7f5edc0a5aeaddae9009ca1317f5af5e31 100644
--- a/src/codegen/compiler.cc
+++ b/src/codegen/compiler.cc
@@ -2107,6 +2107,9 @@ MaybeHandle<JSFunction> Compiler::GetFunctionFromEval(
   int source_length = source->length();
   isolate->counters()->total_eval_size()->Increment(source_length);
   isolate->counters()->total_compile_size()->Increment(source_length);
+// #if BUILDFLAG(BRAVE_PAGE_GRAPH_ENABLED)
+  const int parent_script_id = isolate->GetExecutingScriptId();
+// #endif
 
   // The cache lookup key needs to be aware of the separation between the
   // parameters and the body to prevent this valid invocation:
@@ -2125,7 +2128,11 @@ MaybeHandle<JSFunction> Compiler::GetFunctionFromEval(
   }
   CompilationCache* compilation_cache = isolate->compilation_cache();
   InfoCellPair eval_result = compilation_cache->LookupEval(
-      source, outer_info, context, language_mode, eval_scope_position);
+      source, outer_info, context, language_mode, eval_scope_position
+// #if BUILDFLAG(BRAVE_PAGE_GRAPH_ENABLED)
+      , parent_script_id
+// #endif
+      );
   Handle<FeedbackCell> feedback_cell;
   if (eval_result.has_feedback_cell()) {
     feedback_cell = handle(eval_result.feedback_cell(), isolate);
@@ -2207,7 +2214,11 @@ MaybeHandle<JSFunction> Compiler::GetFunctionFromEval(
         Handle<FeedbackCell> new_feedback_cell(result->raw_feedback_cell(),
                                                isolate);
         compilation_cache->PutEval(source, outer_info, context, shared_info,
-                                   new_feedback_cell, eval_scope_position);
+                                   new_feedback_cell, eval_scope_position
+// #if BUILDFLAG(BRAVE_PAGE_GRAPH_ENABLED)
+                                   , parent_script_id
+// #endif
+                                   );
       }
     }
   } else {
@@ -2223,11 +2234,30 @@ MaybeHandle<JSFunction> Compiler::GetFunctionFromEval(
       Handle<FeedbackCell> new_feedback_cell(result->raw_feedback_cell(),
                                              isolate);
       compilation_cache->PutEval(source, outer_info, context, shared_info,
-                                 new_feedback_cell, eval_scope_position);
+                                 new_feedback_cell, eval_scope_position
+// #if BUILDFLAG(BRAVE_PAGE_GRAPH_ENABLED)
+                                 , parent_script_id
+// #endif
+                                 );
     }
   }
   DCHECK(is_compiled_scope.is_compiled());
 
+// #if BUILDFLAG(BRAVE_PAGE_GRAPH_ENABLED)
+  {
+    EvalScriptCompiledFunc eval_script_compiled_func =
+        isolate->GetEvalScriptCompiledFunc();
+    if (eval_script_compiled_func) {
+      Object maybe_script = result->shared().script();
+      if (maybe_script.IsScript()) {
+        Script script = Script::cast(maybe_script);
+        eval_script_compiled_func(*reinterpret_cast<v8::Isolate*>(isolate),
+            parent_script_id, script.id(), v8::Utils::ToLocal(source));
+      }
+    }
+  }
+// #endif
+
   return result;
 }
 
@@ -2831,7 +2861,7 @@ MaybeHandle<SharedFunctionInfo> Compiler::GetSharedFunctionInfoForScript(
     // First check per-isolate compilation cache.
     maybe_result = compilation_cache->LookupScript(
         source, script_details.name_obj, script_details.line_offset,
-        script_details.column_offset, origin_options, language_mode);
+        script_details.column_offset, origin_options, language_mode, script_details.parent_script_id);
     if (!maybe_result.is_null()) {
       compile_timer.set_hit_isolate_cache();
     } else if (can_consume_code_cache) {
@@ -2849,7 +2879,7 @@ MaybeHandle<SharedFunctionInfo> Compiler::GetSharedFunctionInfoForScript(
         // Promote to per-isolate compilation cache.
         is_compiled_scope = inner_result->is_compiled_scope(isolate);
         DCHECK(is_compiled_scope.is_compiled());
-        compilation_cache->PutScript(source, language_mode, inner_result);
+        compilation_cache->PutScript(source, language_mode, inner_result, script_details.parent_script_id);
         maybe_result = inner_result;
       } else {
         // Deserializer failed. Fall through to compile.
@@ -2886,7 +2916,7 @@ MaybeHandle<SharedFunctionInfo> Compiler::GetSharedFunctionInfoForScript(
     Handle<SharedFunctionInfo> result;
     if (use_compilation_cache && maybe_result.ToHandle(&result)) {
       DCHECK(is_compiled_scope.is_compiled());
-      compilation_cache->PutScript(source, language_mode, result);
+      compilation_cache->PutScript(source, language_mode, result, script_details.parent_script_id);
     } else if (maybe_result.is_null() && natives != EXTENSION_CODE) {
       isolate->ReportPendingMessages();
     }
@@ -3015,7 +3045,7 @@ Compiler::GetSharedFunctionInfoForStreamedScript(
                  "V8.StreamingFinalization.CheckCache");
     maybe_result = compilation_cache->LookupScript(
         source, script_details.name_obj, script_details.line_offset,
-        script_details.column_offset, origin_options, task->language_mode());
+        script_details.column_offset, origin_options, task->language_mode(), script_details.parent_script_id);
     if (!maybe_result.is_null()) {
       compile_timer.set_hit_isolate_cache();
     }
@@ -3106,7 +3136,7 @@ Compiler::GetSharedFunctionInfoForStreamedScript(
       // Add compiled code to the isolate cache.
       TRACE_EVENT0(TRACE_DISABLED_BY_DEFAULT("v8.compile"),
                    "V8.StreamingFinalization.AddToCache");
-      compilation_cache->PutScript(source, task->language_mode(), result);
+      compilation_cache->PutScript(source, task->language_mode(), result, script_details.parent_script_id);
     }
   }
 
